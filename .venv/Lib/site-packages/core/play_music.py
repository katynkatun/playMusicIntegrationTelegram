from gmusicapi import Mobileclient
from .constant import * 

class PlayMusic():
    def __init__(self, device_id = device_id, first = False):
        api = Mobileclient()
        if first:
            api.perform_oauth()
        api.oauth_login(device_id)
        self.api = api 

    def get_api(self):
        return self.api

    def add_setsong_to_play_list(self, play_list_name, set_song_to_add):
        set_songs = set()
        play_list_id = ""
        play_lists = self.api.get_all_playlists()
        for play_list in play_lists:
            if str(play_list["name"]) == play_list_name:
                play_list_id = play_list["id"]
                temp_list_song = self.api.get_shared_playlist_contents(play_list["shareToken"])
                for i in temp_list_song:
                    set_songs.add(i["trackId"])
                break
        if len(set_song_to_add) > 0:
            for j in set_song_to_add:
                if j and not (j in set_songs):
                    self.api.add_songs_to_playlist(play_list_id, j)
        else:
            print("not found")